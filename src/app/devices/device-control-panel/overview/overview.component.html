

<!-- Page Heading -->

<div class="topnavbar bg-white py-2" *ngIf="menuDetail?.accordion_value?.enable_disable || menuDetail?.accordion_value?.delete">
  <div class="row">

    <ul class="nav">
      <li class="nav-item" *ngIf="menuDetail.accordion_value.enable_disable && device?.metadata.status?.toLowerCase() === 'disabled'">
        <a class="nav-link" href="javascript:void(0)" (click)="enableDevice()"  [class.disabled]="isAPILoading">
          <i class="fa fa-fw fa-toggle-on"></i>
          <span class="text-secondary"> Enable</span></a>
      </li>
      <li class="nav-item" *ngIf="menuDetail.accordion_value.enable_disable && device?.metadata.status?.toLowerCase() === 'enabled'">
        <a class="nav-link" href="javascript:void(0)" (click)="openConfirmDialog('Disable')"  [class.disabled]="isAPILoading || device?.metadata.status?.toLowerCase() === 'disabled'">
          <i class="fa fa-fw fa-toggle-off"></i>
          <span class="text-secondary"> Disable</span></a>
      </li>
      <li class="nav-item" *ngIf="menuDetail.accordion_value.delete">
        <a class="nav-link" href="javascript:void(0)" (click)="openConfirmDialog('Delete')" [class.disabled]="isAPILoading">
          <i class="fa fa-fw fa-trash"></i>
          <span class="text-secondary delete-row">Delete</span></a>
      </li>
      <li *ngIf="isAPILoading">
        <i class="fa fa-spinner fa-spin fa-fw fa-2x"></i>
      </li>
    </ul>



  </div>

<div class="row" >
  <div class="col-lg-12">
    <hr class="solid">
  </div>
</div>

</div>
<div class="con-pad " [style.marginTop]="(!menuDetail.accordion_value.enable_disable && !menuDetail.accordion_value.delete) ? '6rem' : ''">
  <div class="d-sm-flex align-items-center justify-content-between mt-1">
    <h4 class="mb-0 text-gray-800 row col-md-6">Welcome to {{device?.tags?.display_name ? device?.tags?.display_name : device?.device_id}}</h4>
    <a
    class="d-none d-sm-inline-block btn btn-sm btn-warning shadow-sm pull-right mr-2"
    href="javascript:void(0)"
    title="Sync with cache"
    (click)="syncWithCache()"
    >Sync with cache <i class="fa fa-refresh fa-sm text-white"></i></a>
  </div>
  <div class="row col-12 mt-1" *ngIf="pageType.toLowerCase() === 'nonipdevice'">
    <h6>This {{tileData.value}} is managed by an IP Gateway ({{device.gateway_id}})</h6>
  </div>
  <div class="row col-12 mt-1">
    <h6>{{tileData.value}} Id is {{device?.device_id}}</h6>
  </div>
  <div class="row col-12 mt-1" *ngIf="pageType === 'gateway'">
    <h6>This is the gateway of type ({{device.tags.device_type}}) managing
      <a  href="javascript:void(0)" (click)="onRedirectToDevices()">
        {{deviceCount}} {{deviceCount === 1 ? 'asset' : 'assets'}}</a>.</h6>
  </div>
  <div class="row col-12 mt-1">
    <!-- <a class="btn-sm shadow-sm white-font"
    [ngClass]="{'btn-success': deviceConnectionStatus?.connection_state === 'Connected',
                'btn-danger': deviceConnectionStatus?.connection_state === 'Disconnected'}">
      {{deviceConnectionStatus?.status.charAt(0).toUpperCase() + deviceConnectionStatus?.status.slice(1)
        + ', ' + deviceConnectionStatus?.connection_state + ' @ ' + deviceConnectionStatus?.local_updated_date}}
    </a> -->
    <p *ngIf="device?.metadata?.status?.toLowerCase() === 'enabled' && device?.metadata?.connection_state?.toLowerCase() === 'connected'">
      Currently, {{pageType}} is
      <span class="enabled-font">
        {{device?.metadata.status}} & Online.</span>
    </p>
    <p *ngIf="device?.metadata?.status?.toLowerCase() === 'enabled' && device?.metadata?.connection_state?.toLowerCase() === 'disconnected'">
      Currently, {{pageType}} is
      <span class="enabled-font">
        {{device?.metadata.status}}</span>, but it is
        <span class="disabled-font">
          Offline.</span>
    </p>
    <p *ngIf="device?.metadata?.status?.toLowerCase() === 'disabled' && device?.metadata?.connection_state?.toLowerCase() === 'disconnected'">
      Currently, {{pageType}} is
      <span class="disabled-font">
        {{device?.metadata.status}} & Offline.</span>
    </p>
  </div>
  <div *ngIf="deviceCredentials" class="mt-1">
    <h6 class="row col-12"><ng-container *ngIf="pageType.toLowerCase() === 'nonipdevice'">Gateway</ng-container>
      Connection String:
      <a class="blue-font ml-2" href="javascript:void(0)" (click)="viewonnectionString()"> View</a>
      <a class="blue-font ml-2" href="javascript:void(0)" (click)="copyConnectionString()"> {{isCopyClicked ? 'Copied' : 'Copy'}}</a>
    </h6>
    <h6  class="row col-12" *ngIf="isViewClicked">{{deviceCredentials.primary_connection_string}}</h6>
  </div>
<div class="text-center mt-5">
  <img class="img-fluid px-3 px-sm-2 mb-4"
  src="{{(blobStorageURL + deviceType?.metadata?.image?.url + blobSASToken)}}" alt="" style="width:15rem;">
</div>
</div>
<!-- <div class="d-sm-flex align-items-center justify-content-between mb-4 pt-3">

  Meta Data <br />
  Device Name: {{device?.device_id}}<br />
  MAC ID:<br />
  Device Type: {{device?.tags?.device_type}}<br /><br />

  Properties List:<br /><br />

  D2C Messages Possible:<br /><br />

  Direct Methods Exposed:<br /><br />

  Twin Patches Possible:<br /><br />

  C2D Commands Possible:<br /><br />

  FOTA format:<br /><br />

  Reboot Format:<br />

</div> -->


<div class="modal fade" id="confirmMessageModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel2">
  <div class="modal-dialog" role="document">
    <app-message-modal
    [bodyMessage]="btnClickType === 'Disable' ? 'This ' + pageType + ' will be temporarily disabled. Are you sure you want to continue?' :
    'This ' + pageType + ' will be permanently deleted. Instead, you can temporarily disable the ' + pageType +'.' +
    ' Are you sure you want to continue?'"
     [headerMessage]="btnClickType + ' Device'"
      (modalEvents)="onModalEvents($event)" [modalConfig]="modalConfig"></app-message-modal>
  </div>
</div>
