<ng-container *ngIf="commonService.appPrivilegesPermission('RV') && commonService.getdecodedToken()?.app === 'Kirloskar' || commonService.getdecodedToken()?.app === 'VNHierarchyTests'">
    <div class="tab-bar">
        <div class="col">
            <form class="form-inline vw-75">
                    <div class="row d-flex vw-100">
                        <div class="col-6 d-flex">
                            <app-date-range-picker *ngIf="originalFilterObj && selectedDateRange" [filterObj]="originalFilterObj" [options]="datePickerOptions" [selectedDateRange]="selectedDateRange" (selectedDateApplyEmitter)="selectedDateApply($event)"></app-date-range-picker>
                            <div class="form-group">
                                <button class="btn btn-sm searchBtn btn-primary" type="button" name="search-hierarchy" placement="bottom" tooltip="Search" 
                                (click)="dailyReportsData=[] ; preOffset= 0 ; getReportDatabySearch()" [disabled]="dailyReportApiLoading">
                                    <em class="fa fa-search fa-sm"></em>
                                </button>
                            </div>
                        </div>
                        <div class="col-6 d-flex justify-content-end">
                            <div class="form-group">
                                <a href="javascript:void(0)" (click)="saveAsExcel()" [style.pointer-events]="dailyReportApiLoading" placement="left" tooltip="Export as Excel" class="ml-1" >
                                    <em class="fa fa-lg fa-file-excel-o"></em>
                                </a>
                            </div>    
                        </div>
                    </div>
                </form>
            </div>
    </div>
    <div class="overlap-wrapper vh-50">
        <div class="over-lap">
            <div class="tableFixHead">
                <div class="table-responsive">
                    <table class="table table-hover" aria-describedby="">
                        <thead class="table-header">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">FM-101 (Suction) Diff. Kg</th>
                                <th scope="col">FM-102 (Discharge) Diff. Kg</th>
                                <th scope="col">FM-103 (IC) Diff. Kg</th>
                                <th scope="col">Vent Diff. Kg</th>
                                <th scope="col">Total Diff. FM(101-102-103-Vent) Kg</th>
                                <th scope="col">% Volumetric Eff.</th>
                                <th scope="col">Fuel Consumption KG/HR</th>
                                <th scope="col">Power Consumption KW/HR</th>
                                <th scope="col">Error (%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngIf="dailyReportsData" >
                                <tr *ngFor="let report of dailyReportsData; let i = index">
                                    <td>{{report.reportDate | date : 'dd-MMM-yyyy'}} </td>
                                    <td>{{report?.suctionDiff}}</td>
                                    <td>{{report?.dischargeDiff}}</td>
                                    <td>{{report?.fM103Diff}}</td>
                                    <td>{{report?.ventDiff}}</td>
                                    <td>{{report?.totalDiff}}</td>
                                    <td>{{report?.volumetricEfficiency}}</td>
                                    <td>{{report?.fuelConsumption}}</td>
                                    <td>{{report?.powerConsumption}}</td>
                                    <td>{{report?.error}}</td>
                                </tr>
                            </ng-container>
                            <ng-container *ngIf="dailyReportsData?.length===0">
                                <tr>
                                    <td colspan="7">Daily Reports not available.</td>
                                </tr>
                            </ng-container>
                            <ng-container *ngIf="dailyReportApiLoading">
                                <tr>
                                  <td colspan="7">
                                    <em class="fa fa-fw fa-2x  fa-spin fa-spinner"></em>
                                  </td>
                                </tr>
                              </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="loadMoreBtn " [style.height]="loadMoreVisible ? '2rem' : '0' ">
                <span class="pull-center " *ngIf="loadMoreVisible && !dailyReportApiLoading">
                    <a href="javascript:void(0)" class=""
                      (click)="preOffset = preOffset + preLimit; getReportDatabySearch();" >Load More...</a>
                  </span>
            </div>
            </div>
        </div>
    
    
    <div class="modal fade" id="downloadReportModel" tabindex="-1" aria-labelledby="exampleModalLabel" role="dialog">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h6 class="modal-title fs-5" id="exampleModalLabel">Downloading {{selectedAsstDetails?.display_name ? selectedAsstDetails.display_name : selectedAsstDetails?.asset_id }} Daily Report</h6>
              <button type="button" class="close" *ngIf="loadingMessage" (click)="cancelDownloadModal()">
                <span aria-hidden="true" tooltip="Close">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <ng-container>
                  {{loadingMessage}}
                  <em class="fa fa-spinner fa-spin fa-fw fa-2x"></em>
                </ng-container>
              </div>
              <div class="modal-footer" *ngIf="loadingMessage?.toLowerCase()?.includes('loading')">
                <button type="button" class="btn btn-secondary add-row" (click)="cancelDownloadModal()">Cancel</button>
              </div>
          </div>
        </div>
      </div>
</ng-container>
