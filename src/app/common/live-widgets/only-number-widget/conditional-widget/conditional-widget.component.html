<div class="mt-1">
  <div class="card" id="{{chartConfig.chartId}}">
    <div class="card-header d-flex px-2">
      <div style="min-width: 0; flex:1">
        <h6 class="my-0 live-widget-title" placement="bottom" [tooltip]="chartConfig.widgetTitle"
          [ngClass]="{'w-11': !asset  && !chartConfig.freezed}">
          {{chartConfig.widgetTitle}}
        </h6>
      </div>
      <div *ngIf="!asset" class="ml-auto">
        <div class="round-badge badge-navyblue" tooltip="Derived KPI" *ngIf="chartConfig.derived_kpis">DK</div>
        <div class="round-badge badge-darkblue" tooltip="Edge Derived Property" *ngIf="chartConfig.edge_derived_props">
          ED</div>
        <div class="round-badge badge-lightblue" tooltip="Cloud Derived Property"
          *ngIf="chartConfig.cloud_derived_props">CD</div>

        <div class="round-badge badge-blue" tooltip="Measured Property" *ngIf="chartConfig.measured_props">M</div>

        <a *ngIf="!asset && !chartConfig.freezed && decodedToken?.privileges?.indexOf('ASMMM') > -1"
          href="javascript:void(0)" (click)="openConfirmRemoveWidgetModal()" placement="bottom"
          tooltip="Remove {{widgetStringFromMenu}}"><em class="fa fa-close"></em></a>

      </div>
    </div>
    <div class="card-body1 card-height">
      <div class="row text-center " *ngIf="telemetryObj">
        <div *ngIf="!asset">
          <div class="col-md-12" *ngFor="let prop of chartConfig.properties; let i = index">
            {{evaluatePropConditionwithoutasset(telemetryObj,prop)}}

            <div class="mt-1 ml-1 mr-3" *ngIf="chartConfig.widgetType === 'NumberWithTrend'">
              <app-line-chart-without-axis [asset]="asset"
                [chartId]="chartConfig.chartId + '_' + (prop?.property?.json_key || prop.title) + '_' + i"
                [chartConfig]="chartConfig" [telemetryObj]="telemetryObj" [property]="prop.property?.json_key">
              </app-line-chart-without-axis>
            </div>
            <div class="text-center" *ngIf="chartConfig.widgetType === 'NumberWithImage'">
              <img class="img-fluid px-2 img-szmd" src="{{blobStorageURL + prop?.image?.url + blobToken
                }}" alt="" />
            </div>
            <div
              *ngIf="(chartConfig.widgetType === 'ConditionalNumber' || chartConfig.widgetType === 'StringWidget') && !asset"
              style="height:7rem;">
              <div class="ConditionalNumber"></div>
            </div>
            <div
              [ngClass]="{'mt-4': chartConfig.widgetType === 'ConditionalNumber' || chartConfig.widgetType === 'StringWidget'}"
              [ngStyle]="{'margin-top': chartConfig.widgetType === 'NumberWithTrend' && !asset ? '1rem' : '' }">
              <span class="text-grey">
                <ng-container *ngIf="prop.load_value_using !== 'api' else APIPropDateTemplate">
                  {{telemetryObj[prop.json_Data[0]?.json_key]?.date ||
                  telemetryObj[prop.json_Data[0]?.json_key]?.message_date}}
                </ng-container>
                <ng-template #APIPropDateTemplate>
                  {{apiTelemetryObj[prop.composite_key]?.date ||
                  apiTelemetryObj[prop.composite_key]?.message_date}}
                </ng-template>
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- New Code -->

      <div *ngIf="asset" class="d-flex flex-column justify-content-center align-items-center card-height2">
        <span class="status mb-4">
          {{evaluatePropCondition(telemetryObj)}}
        </span>
        <span class="text-grey">
          {{telemetryObj[chartConfig?.properties[0]?.composite_key]?.date }}
        </span>
      </div>
      <!-- New Code -->


    </div>
  </div>
</div>

<div class="modal fade" id="confirmRemoveWidgetModal{{chartConfig.chartId}}" tabindex="-1" role="dialog"
  aria-labelledby="ModalLabel2">
  <div class="modal-dialog" role="document">
    <app-confirm-modal *ngIf="modalConfig" [bodyMessage]="bodyMessage" [headerMessage]="headerMessage"
      (modalEvents)="onModalEvents($event)" [modalConfig]="modalConfig"></app-confirm-modal>
  </div>
</div>