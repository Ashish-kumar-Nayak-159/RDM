<div class="table-responsive table-fixHead mt-2">
  <div class="col-lg-12" *ngIf="selectedWidget">

    <div class="col-lg-6 col-xl-6 align-self-center">
      <div class="row">
        <!-- <div><a href="javascript:void(0)" [class.disabled]="sentMessageData || !selectedWidget" (click)="validateMessage()" ><button type="button" class="btn btn-primary contact-form" > 1. Validate</button></a></div>
    <div class='px-1'><hr></div> -->
        <div><a href="javascript:void(0)" [class.disabled]="!selectedWidget && !isInvokeDirectMethod || responseMessage"
            (click)="invokeDirectMethod()">
            <button type="button" class="btn btn-sm btn-primary"> Invoke Method
              <i class="fa fa-spinner fa-spin fa-fw " *ngIf="isInvokeDirectMethod"></i>
            </button>
          </a></div>
      </div>
    </div>
  </div>
  <div class="content-scroll content-scroll-control-c2d">
    <div class="row col-lg-12 mt-2" *ngIf="selectedWidget">
      <div class="col-lg-12 col-xl-12">
        <!-- Page Heading -->
        <div class="table-responsive">
          <div class="d-sm-flex align-items-center justify-content-between my-2">
            <h6 class="h6 mb-0">Metadata:</h6>
          </div>
          <table class="table table-hover table-bordered">
            <thead>
              <tr>
                <th scope="col">Key</th>
                <th scope="col"class="border-left">Value</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>Asset</td>
                <td *ngIf="componentState !== constantData.IP_GATEWAY">{{directMethodData.asset_id}}
                </td>
                <td *ngIf="componentState === constantData.IP_GATEWAY">
                  <select class="custom-select" id="asset_id" name="asset_id" [(ngModel)]="directMethodData.asset_id">

                    <option *ngFor="let asset of assets" [ngValue]="asset.asset_id">
                      {{asset?.display_name ? asset?.display_name : asset.asset_id}}
                    </option>
                    <option [ngValue]="asset.asset_id"> {{asset.asset_id}}</option>
                  </select>
                </td>
              </tr>
              <tr *ngIf="componentState === constantData.NON_IP_ASSET">
                <td>Gateway ID</td>
                <td>{{directMethodData.gateway_id}}</td>
              </tr>
              <tr>
                <td>Job ID</td>
                <td>{{directMethodData.job_id}}</td>
              </tr>
              <tr>
                <td>Connection Timeout (In Seconds)</td>
                <td>
                  <input type="number" class="form-control form-control-sm" name="connection_timeout" min="5" max="300"
                    [(ngModel)]="selectedWidget.connection_timeout_in_sec">
                </td>
              </tr>
              <tr>
                <td>Response Timeout (In Seconds)</td>
                <td>
                  <input type="number" class="form-control form-control-sm" name="response_timeout_in_sec" min="5"
                    max="300" [(ngModel)]="selectedWidget.response_timeout_in_sec">
                </td>
              </tr>

            </tbody>
          </table>
        </div>

        <div class="table-responsive mt-2">
          <div class="d-sm-flex align-items-center justify-content-between my-2">
            <h6 class="h6 mb-0">Message Body / Message JSON:</h6>
          </div>
          <table class="table table-hover table-bordered">
            <tbody>
              <tr>
                <td>Name</td>
                <td>{{selectedWidget.json.method_name}}
                </td>
              </tr>
              <tr *ngIf="selectedWidget?.metadata?.widget_type === 'Asset'">
                <td>Asset</td>
                <td>
                  <select class="form-control form-control-sm" id="asset" name="asset" [(ngModel)]="selectedAssetValue">
                    <option [ngValue]="undefined">Select Asset</option>
                    <option [ngValue]="asset.asset_id" *ngFor="let asset of assets;">{{asset.asset_id}}</option>
                  </select>
                </td>
              </tr>
              <tr *ngIf="selectedWidget?.metadata?.widget_type === 'Slave'">
                <td>Slave/Sensor</td>
                <td>
                  <select class="form-control form-control-sm" id="slave" name="slave" [(ngModel)]="selectedSlaveValue">
                    <!-- <option [ngValue]="undefined" >Select Communication Technique</option> -->
                    <option [ngValue]="undefined">Select Slave/Sensor</option>
                    <option [ngValue]="slave.slave_id" *ngFor="let slave of slaves;">{{slave.slave_name}}</option>
                  </select>
                </td>
              </tr>
              <ng-container *ngFor="let item of jsonModelKeys; let i = index;">
                <tr>
                  <td>
                    <label for="inputPassword" class="col-form-label">{{item.name}}</label>
                  </td>
                  <td>
                    <div>
                      <ng-container *ngIf="item?.json?.type === 'string'">
                        <input type="text" class="form-control form-control-sm" name="{{item.name}}"
                          [(ngModel)]="item.value" minlength="{{item.json.minLength ? item.json.minLength : 1}}"
                          maxLength="{{item.json.maxLength ? item.json.maxLength : 50}}">
                      </ng-container>
                      <ng-container *ngIf="item?.json?.type === 'number'">
                        <input type="number" class="form-control form-control-sm" name="{{item.name}}"
                          [(ngModel)]="item.value"
                          min="{{item.json.minValue !== undefined || item.json.minValue !== null ? item.json.minValue : null}}"
                          max="{{item.json.maxValue !== undefined || item.json.maxValue !== null  ? item.json.maxValue : null}}"
                          step="any">
                      </ng-container>
                      <ng-container *ngIf="item?.json?.type === 'boolean'">
                        <div class="btn-group" name="booleandata">

                          <ui-switch checkedLabel="{{item.json.trueValue}}" uncheckedLabel="{{item.json.falseValue}}"
                            size="small" [(ngModel)]="item.value" id="{{item.name}}" name="{{item.name}}"
                            uncheckedTextColor="red" defaultBgColor="red" checkedTextColor="white"
                            uncheckedTextColor="white"></ui-switch>

                        </div>
                      </ng-container>
                      <ng-container *ngIf="item.json.type === 'enum'">
                        <select class="form-control form-control-sm custom-select" id="widget" name="acknowledge"
                          [(ngModel)]="item.value">
                          <option [ngValue]="val.value" *ngFor="let val of item.json.enum">{{val.label}}</option>
                        </select>
                      </ng-container>
                    </div>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
      <div class="col-lg-12 col-xl-12 col-md-12" *ngIf="responseMessage">
        <div class="d-sm-flex align-items-center justify-content-between mb-2 pt-3">
          <h6 class="h6 mb-0">Response:</h6>
        </div>

        <form id="contact-form">
          <div class="form-group mr-3">
            <textarea class="form-control" id="message" rows="13" name="message" disabled
              [defaultValue]="responseMessage | json"></textarea>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>
