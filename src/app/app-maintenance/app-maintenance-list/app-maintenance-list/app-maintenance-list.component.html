<div class="blue-nav-bar">
    <!-- Diplay the Title and the + icon  -->
    <div class="d-flex align-items-center">
        <div class="d-flex align-items-center">

            <div class="main-heading">{{(tileData && tileData[0] ? tileData[0]?.value : '')}}&nbsp;
            </div>
            <button type="submit" class="btn btn-sm searchBtn btn-primary" (click)="openCreateMaintenanceModelModal()"
                *ngIf="decodedToken?.privileges && decodedToken.privileges.indexOf('ASCMM') > -1" placement="bottom"
                tooltip="Add {{(tileData && tileData[1] ? tileData[1]?.value : '')}}"><em
                    class="fas fa-plus fa-sm"></em></button>
        </div>
        <!-- Display the Hierachy and Search Icon display -->
        <div class="ml-auto">
            <div class="">
                <form class="form-inline">
                    <app-hierarchy-dropdown #hierarchyDropdown *ngIf="filterObj" [showAsset]="true"
                        [closeOnSelection]="true" [filterObj]="filterObj" [assets]="assets"
                        (saveHierarchyEvent)="onSaveHierachy()" (clearHierarchyEvent)="onClearHierarchy()">
                    </app-hierarchy-dropdown>
                    <!-- <div class="form-group">
                <button type="button" class="btn btn-sm searchBtn btn-primary"
                    (click)="onFilterSelection(this.filterObj, true, true)"><em
                        class="fas fa-search fa-sm"></em>
                </button>
            </div> -->
                </form>
            </div>
        </div>
    </div>

    <div>
       <div >
        <app-common-data-table [tableData]="maintenances" [tableConfig]="tableConfig"
        (btnClickEvent)="onTableFunctionCall($event)"></app-common-data-table>
       </div>
    </div>
    <div class="modal fade" id="confirmMessageModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel2">
        <div class="modal-dialog" role="document">
          <app-message-modal [bodyMessage]="confirmBodyMessage" [headerMessage]="confirmHeaderMessage"
            (modalEvents)="onModalEvents($event)" [modalConfig]="modalConfig" [isAPILoading]="isAPILoading">
          </app-message-modal>
        </div>
      </div>
</div>

<div class="modal right fade" id="createMaintainenceModelModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel2">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Maintenance Schedule</h5>
        <button type="button" class="close"  (click)="onCloseMaintenanceModelModal()" aria-label="Close" >
          <span aria-hidden="true" tooltip="Close">&times;</span>
        </button>
      </div>
      <div class="modal-body" >
        <form  [formGroup]="createMaintenanceForm">
          <div class="form-group" >
            <label for="message-text" class="col-form-label required">Name</label>
            <input type="text" class="form-control form-control-sm" id="maintenance_name" formControlName="maintenance_name">
            <div *ngIf="createMaintenanceForm.get('maintenance_name').errors && createMaintenanceForm.get('maintenance_name').touched"
              class="alert-danger">
              <div *ngIf="createMaintenanceForm.get('maintenance_name').errors.required">
                Maintenanace Name is required.
              </div>
              </div>
          </div>
          <div class="form-group" >
            <label for="message-text" class="col-form-label required">Asset</label>
            
            <ng-select [items]="assetDropdown" class="custom-dropdown w-12 sm" required 
            [clearable]="false" [searchable]="true" bindLabel="asset_id" [closeOnSelect]="true"
            placeholder="Select Asset" groupBy="asset_type" dropdownPosition="bottom" name="asset-dropdown"
            bindValue="asset_id"  [(ngModel)]="selectedAsset_id" formControlName="selectedAsset_id">
            <ng-template ng-option-tmp let-item="item">
                <span [tooltip]="item.asset_name">
                 {{item.asset_name}}
                </span>
             </ng-template>
          </ng-select>
          <div *ngIf="createMaintenanceForm.get('selectedAsset_id').errors && createMaintenanceForm.get('maintenance_name').touched"
          class="alert-danger">
          <div *ngIf="createMaintenanceForm.get('selectedAsset_id').errors.required">
            Asset is required.
          </div>
          </div>
        
          </div>
          <div class="form-group" >
            <label for="message-text" class="col-form-label ">Email Body</label>
            <app-text-editor formControlName="htmlEmailContent"></app-text-editor>
          </div>
            <div class="form-group" >
            <label for="message-text" class="col-form-label ">Description</label>
            <app-text-editor formControlName="descContent"></app-text-editor>
          </div>
          <div class="form-group" >
            <label for="message-text" class="col-form-label required">Maintenance Start Date</label>
            <input [owlDateTime]="dt1" formControlName="maintenance_Sdate" class="form-control form-control-sm" [owlDateTimeTrigger]="dt1" placeholder="Date Time">
            <owl-date-time #dt1></owl-date-time>
            <div *ngIf="createMaintenanceForm.get('maintenance_Sdate').errors && createMaintenanceForm.get('maintenance_Sdate').touched"
            class="alert-danger">
            <div *ngIf="createMaintenanceForm.get('maintenance_Sdate').errors.required">
              Maintenance Start Date is required.
            </div>
            </div>
         </div>
          <div class="form-group" >
            <label for="recipient-name" class="col-form-label required">Inspection Frequency</label>
            <select class="form-control form-control-sm" id="template" formControlName="inspection_frequency" name="model_type" >
                <option value="0">Daily</option>
                <option value="1">Weekly</option>
                <option value="2">BiWeekly</option>
                <option value="3">Monthly</option>
                <option value="4">Quarterly</option>
             </select>
             <div *ngIf="createMaintenanceForm.get('inspection_frequency').errors && createMaintenanceForm.get('inspection_frequency').touched"
             class="alert-danger">
             <div *ngIf="createMaintenanceForm.get('inspection_frequency').errors.required">
              Inspection Frequency is required.
             </div>
             </div>
          </div>
          <div class="form-group" >
            <label class="col-form-label " for="alert_management">Notify to User</label>
            <input type="checkbox" class="form-check-input checkboxloc" id="nuser_management" name="nuser_management"
            formControlName="is_notify_user" 
                  (change)="onChangeOfSendNotifyAlertCheckbox()">
          </div>
          <div *ngIf="is_notify_user">
            <div class="form-group" >
              <label for="message-text" class="col-form-label required">Notify Before</label>
              <input type="email" required class="form-control form-control-sm" id="nbefore_name" [(ngModel)]="notifyBefore">
            </div>
            <div class="form-group" >
              <label for="message-text" class="col-form-label required">Notify User Email Id</label>
              <input type="email" required class="form-control form-control-sm" id="app_name" [(ngModel)]="notify_user_emails">
            </div>
            <div class="form-group" >
              <label for="message-text" class="col-form-label required">Notify Email Subject</label>
              <input type="text" class="form-control form-control-sm" id="maintenance_name" [(ngModel)]="notify_email_subject">
            </div>
            <div class="form-group" >
              <label for="message-text" class="col-form-label required">Notify Email Body</label>
              <app-text-editor [(ngModel)]="notify_email_body"></app-text-editor>
            </div>
          </div>
          <div class="form-group" >
            <label class="col-form-label " for="alert_management">Acknowledge Required</label>
            <input type="checkbox" class="form-check-input checkboxloc" id="auser_management" name="auser_management"
            formControlName="is_acknowledge_required"
                (change)="onChangeOfSendNotifyAlertCheckbox()">
          </div>
          <div class="form-group" >
            <label class="col-form-label " for="alert_management">Escalation Required</label>
            <input type="checkbox" class="form-check-input checkboxloc" id="euser_management" name="euser_management"
            formControlName="is_escalation_required"
                (change)="onChangeOfSendNotifyAlertCheckbox()">
          </div>
          <div *ngIf="is_escalation_required">
          <div class="form-group" >
            <label for="message-text" class="col-form-label required">User/Email Id(Escalation 1)</label>
            <input type="email" required class="form-control form-control-sm" id="app_name" [(ngModel)]="escalation_emailids1">
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label required " [(ngModel)]="dateTime1">Escalation 1 Date & Time</label>
            <input [owlDateTime]="dt1" class="form-control form-control-sm" [owlDateTimeTrigger]="dt1" placeholder="Date Time">
            <owl-date-time #dt1></owl-date-time>
            </div>
          <div class="form-group" >
            <label for="message-text" class="col-form-label">User/Email Id(Escalation 2)</label>
            <input type="email" class="form-control form-control-sm"  id="app_name" [(ngModel)]="escalation_emailids2">
          </div>
          <div class="form-group" >
            <label for="recipient-name" class="col-form-label ">Escalation 2 Date & Time </label>
            <input [owlDateTime]="dt1" [owlDateTimeTrigger]="dt1" [(ngModel)]="dateTime2" class="form-control form-control-sm" placeholder="Date Time">
            <owl-date-time #dt1></owl-date-time>
              </div>
             <div class="form-group" >
                <label for="message-text" class="col-form-label">User/Email Id(Escalation 3)</label>
                <input type="email" class="form-control form-control-sm" id="app_name" [(ngModel)]="escalation_emailids3">
              </div>
              <div class="form-group" >
                <label for="recipient-name" class="col-form-label ">Escalation 3 Date & Time </label>
                <input [owlDateTime]="dt1" [owlDateTimeTrigger]="dt1" [(ngModel)]="dateTime3" class="form-control form-control-sm" placeholder="Date Time">
                <owl-date-time #dt1></owl-date-time>
              </div>
            </div>
                <div class="modal-footer fixed-bottom bg-white" >
              <button type="button" class="btn btn-primary add-row" 
                (click)="onSaveMaintenanceModelModal()">Save</button>
              <button type="button" class="btn btn-secondary" 
                (click)="onCloseMaintenanceModelModal()">
                Cancel
              </button>
              <!-- <em class="fa fa-spinner fa-spin fa-fw fa-2x" ></em>
            -->
            </div>
  
          </form>
        </div>
      </div>
    </div>
  </div>