<div class="mt-1">
    <div class="card " id="{{chartConfig.chart_id}}">
        <div class="card-header d-flex px-2">
            <div style="min-width: 0; flex:1">
                <h6 class="my-0 live-widget-title text-center w-100" placement="bottom"
                    [tooltip]="chartConfig.widget_title" [ngClass]="{'w-11': !asset  && !chartConfig.freezed}"
                    maxlength="10">
                    {{chartConfig.widget_title}}
                </h6>
            </div>
            <div class="ml-auto">
                <div class="round-badge badge-navyblue" tooltip="Derived KPI"
                    *ngIf="chartConfig.derived_kpis && !asset && !chartConfig.freezed">DK</div>
                <div class="round-badge badge-darkblue" tooltip="Edge Derived Property"
                    *ngIf="chartConfig.edge_derived_props && !asset && !chartConfig.freezed">
                    ED</div>
                <div class="round-badge badge-lightblue" tooltip="Cloud Derived Property"
                    *ngIf="chartConfig.cloud_derived_props && !asset && !chartConfig.freezed">CD</div>

                <div class="round-badge badge-blue" tooltip="Measured Property"
                    *ngIf="!asset && !chartConfig.freezed && chartConfig.measured_props">M</div>
                <!-- <a *ngIf="!asset && !chartConfig.freezed && decodedToken?.privileges?.indexOf('ASMMM') > -1"
                    href="javascript:void(0)" (click)="openConfirmRemoveWidgetModal()" placement="bottom"
                    tooltip="Remove {{widgetStringFromMenu}}"><em class="fa fa-close"></em></a> -->

                <button (click)="$event.stopPropagation()" class="border-0 btnStyle"
                    style="background-color: transparent;" mat-icon-button [matMenuTriggerFor]="menu"
                    aria-label="Example icon button with a horizontal three dot icon">
                    <i class='fas fa-ellipsis-v'></i>
                </button>
                <mat-menu class="micon" #menu="matMenu">
                    <button mat-menu-item (click)="onMenu(0)"><i class="fa fa-edit"></i> Edit</button>
                    <button mat-menu-item (click)="onMenu(1)"><i class="fa fa-clone" aria-hidden="true"></i>
                        Clone</button>
                    <button mat-menu-item (click)="openConfirmRemoveWidgetModal()"
                        *ngIf="!asset && !chartConfig.freezed && decodedToken?.privileges?.indexOf('ASMMM') > -1">
                        <i class="fa fa-trash" aria-hidden="true"></i> Delete
                    </button>
                </mat-menu>

            </div>
        </div>
        <div class="card-body1 card-height">
            <div class="row text-center " *ngIf="telemetryObj">
                <div class="col-md-{{(chartConfig?.properties?.length>=6 ? ((12 / chartConfig?.properties?.length) + (chartConfig.widget_type === 'NumberWithTrend' || chartConfig.widget_type === 'NumberWithImage' ? 2 : 1)) : (12 / chartConfig?.properties?.length)) | number: '1.0-0'}} text-center widget-row-separator"
                    *ngFor="let prop of chartConfig.properties; let i = index"
                    [ngClass]="{'border-left': i > 0 && ((i % 6 != 0 && chartConfig.widget_type != 'NumberWithTrend' && chartConfig.widget_type != 'NumberWithImage') || (i % 4 != 0 && (chartConfig.widget_type === 'NumberWithTrend' || chartConfig.widget_type === 'NumberWithImage'))),'border-right' : i > 5 && i == chartConfig.properties.length -1}">

                    <div class="mt-1 ml-1 mr-3" *ngIf="chartConfig.widget_type === 'NumberWithTrend'">

                    </div>

                    <div *ngIf="contextApp.app!='Kirloskar'"
                        [ngClass]="{'mt-4': chartConfig.widget_type === 'SmallNumber' || chartConfig.widget_type === 'StringWidget'}">
                        <span class="text-darkblue display-5 font-weight-bold"
                            [ngStyle]="{'font-size': chartConfig.widget_type === 'SmallNumber' || chartConfig.widget_type === 'StringWidget' ? '1.3rem' : '' }">
                            <ng-container *ngIf="prop.load_value_using !== 'api' else APIPropValTemplate">

                                {{ (telemetryObj[prop.property?.json_key] &&
                                (telemetryObj[prop.property?.json_key]?.value !==
                                undefined
                                && telemetryObj[prop.property?.json_key]?.value !== null)) ?
                                (prop.property?.data_type === 'Number' ?
                                (convertToNumber(telemetryObj[prop.property?.json_key]?.value)) :
                                (telemetryObj[prop.property?.json_key].value))
                                : 'NA'}}
                                <sub class="text-xs live-widget-title mb-0">
                                    {{prop.property?.json_model[prop.property?.json_key]?.units ? ('(' +
                                    prop.property?.json_model[prop.property?.json_key]?.units + ')') : ''}}
                                </sub>

                            </ng-container>

                            <ng-template #APIPropValTemplate>
                                {{ (apiTelemetryObj[prop.property?.json_key] &&
                                (apiTelemetryObj[prop.property?.json_key]?.value !==
                                undefined && apiTelemetryObj[prop.property?.json_key]?.value !== null)) ?
                                (prop.property?.data_type === 'Number' ?
                                (apiTelemetryObj[prop.property?.json_key]?.value?.toFixed(prop.digitsAfterDecimals)) :
                                (apiTelemetryObj[prop.property?.json_key].value))
                                : 'NA'}} {{prop.unit}}
                            </ng-template>
                        </span>
                    </div>
                    <div *ngIf="contextApp.app=='Kirloskar'"
                        [ngClass]="{'mt-4': chartConfig.widget_type === 'SmallNumber' || chartConfig.widget_type === 'StringWidget'}">
                        <span class="text-darkblue display-5 font-weight-bold"
                            [ngStyle]="{'font-size': chartConfig.widget_type === 'SmallNumber' || chartConfig.widget_type === 'StringWidget' ? '1.3rem' : '' }">
                            <ng-container *ngIf="prop.load_value_using !== 'api' else APIPropValTemplate">

                                {{ (telemetryObj[prop.property?.json_key] &&
                                (telemetryObj[prop.property?.json_key]?.value !==
                                undefined
                                && telemetryObj[prop.property?.json_key]?.value !== null)) ?
                                (prop.property?.data_type === 'Number' ?
                                (telemetryObj[prop.property?.json_key]?.value) :
                                (telemetryObj[prop.property?.json_key].value))
                                : 'NA'}}
                                <sub class="text-xs live-widget-title mb-0">
                                    {{prop.property?.json_model[prop.property?.json_key]?.units ? ('(' +
                                    prop.property?.json_model[prop.property?.json_key]?.units + ')') : ''}}
                                </sub>

                            </ng-container>

                            <ng-template #APIPropValTemplate>
                                {{ (apiTelemetryObj[prop.property?.json_key] &&
                                (apiTelemetryObj[prop.property?.json_key]?.value !==
                                undefined && apiTelemetryObj[prop.property?.json_key]?.value !== null)) ?
                                (prop.property?.data_type === 'Number' ?
                                (apiTelemetryObj[prop.property?.json_key]?.value) :
                                (apiTelemetryObj[prop.property?.json_key].value))
                                : 'NA'}} {{prop.unit}}
                            </ng-template>
                        </span>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="confirmRemoveWidgetModal{{chartConfig.chart_id}}" tabindex="-1" role="dialog"
    aria-labelledby="ModalLabel2">
    <div class="modal-dialog" role="document">
        <app-confirm-modal *ngIf="modalConfig" [bodyMessage]="bodyMessage" [headerMessage]="headerMessage"
            (modalEvents)="onModalEvents($event)" [modalConfig]="modalConfig"></app-confirm-modal>
    </div>
</div>