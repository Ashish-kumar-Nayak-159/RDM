<div class="blue-nav-bar">
  <div class="d-flex">
       <div class="d-flex">
         <div class="main-heading">{{tileData ? tileData['Title'] : ''}}</div>
         <div id="view-tabs" >
       <nav>
         <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
           <!-- <a class="nav-item nav-link border-0 active" id="nav-home-tab" data-toggle="tab" href="#Meta-data" role="tab" aria-controls="nav-home" aria-selected="true"><i class="fas fa-list"></i></a>
           <a class="nav-item nav-link border-0" id="nav-profile-tab" data-toggle="tab" href="#Device" role="tab" aria-controls="nav-profile" aria-selected="false"><i class="fa fa-map-marker-alt" aria-hidden="true"></i></a> -->
           <a href="javascript:void(0)" class="nav-item nav-link border-0" [ngClass]="{'active': currentPageView === 'list'}"  placement="bottom" tooltip="List View" (click)="onCurrentPageViewChange('list')">
            <i class="fas fa-list" ></i></a>
          <a href="javascript:void(0)" class="nav-item nav-link border-0" [ngClass]="{'active': currentPageView === 'map'}"  placement="bottom" tooltip="Map View" (click)="onCurrentPageViewChange('map')">
            <i class="fa fa-map-marker-alt"></i></a>
         </div>
       </nav>
      </div>
     </div>
   <div class="ml-auto">
     <div class="asset-nav-tabs" >
       <nav>
         <div class="nav nav-tabs nav-fill " id="nav-tab" role="tablist">
           <a class="nav-item nav-link border-0" *ngIf="iotAssetsTab?.visibility" id="nav-home-tab" data-toggle="tab" (click)="onTabChange(constantData.IP_DEVICE)"
           href="#{{iotAssetsTab?.tab_name}}" role="tab" aria-controls="nav-home" aria-selected="true" [ngClass]="{'active': componentState === constantData.IP_DEVICE}">
             <i class="fab fa-mixcloud mr-2"></i>
            <span class="d-none d-md-inline-block">{{iotAssetsTab?.tab_name}}</span></a>
           <a class="nav-item nav-link border-0"  *ngIf="legacyAssetsTab?.visibility" id="nav-profile-tab" data-toggle="tab" (click)="onTabChange(constantData.NON_IP_DEVICE)"
           href="#{{legacyAssetsTab?.tab_name}}" role="tab" aria-controls="nav-profile" aria-selected="false" [ngClass]="{'active': componentState === constantData.NON_IP_DEVICE}">
           <i class="fa fa-microchip mr-2" aria-hidden="true"></i>
           <span class="d-none d-md-inline-block">{{legacyAssetsTab?.tab_name}}</span></a>
           <a class="nav-item nav-link border-0" *ngIf="iotGatewaysTab?.visibility" id="nav-profile-tab" data-toggle="tab" (click)="onTabChange(constantData.IP_GATEWAY)"
           href="#{{iotGatewaysTab?.tab_name}}" role="tab" aria-controls="nav-profile" aria-selected="false" [ngClass]="{'active': componentState === constantData.IP_GATEWAY}">
           <i class="fas fa-sitemap mr-2" aria-hidden="true"></i>
           <span class="d-none d-md-inline-block">{{iotGatewaysTab?.tab_name}}</span></a>
         </div>
       </nav>
      </div>
   </div>
</div>
</div>
<div class="">
  <div id="assetTabContent" class="tab-content">
     <div class="tab-pane fade show active">

      <div class="tab-bar">
        <form class="form-inline">
          <div class="form-group">
            <button href="#" role="button" class="dropdown-btn" data-toggle="dropdown"
            [ngClass]="{'active': hierarchyString}"
            placement="bottom" [tooltip]="hierarchyString ? hierarchyString : 'Select Hierarchy'"
              (click)="onDeviceFilterBtnClick()" aria-haspopup="true" aria-expanded="false">
              <i class="fas fa-fw fa-filter fa-sm button-divider"></i> {{hierarchyString ? displayHierarchyString : 'Select Hierarchy'}}</button>
            <div class="dropdown-menu dropdown-filter-content" id="liveDataSelectAssret">
              <ng-container *ngFor="
                          let level of contextApp?.hierarchy?.levels;
                          let index = index
                        ">
                <div class="">
                  <select *ngIf="index !== 0" name="{{level}}_{{index}}" class="dropdown-form" id="{{ level }}"
                    [disabled]="contextApp?.user?.hierarchy[level]" [(ngModel)]="configureHierarchy[index]"
                    name="{{ level }}" (change)="onChangeOfHierarchy(index)">
                    <option [ngValue]="undefined">
                      Select {{ level }}
                    </option>
                    <option [ngValue]="tag" *ngFor="let tag of hierarchyArr[index]">
                      {{ tag }}
                    </option>
                  </select>
                  <input type="text" *ngIf="index === 0" name="{{level}}_{{index}}" defaultValue="{{ contextApp.app }}"
                    disabled class="dropdown-form" />
                </div>
              </ng-container>
            </div>
          </div>
          <div class="form-group"><button type="button" class="btn btn-sm searchBtn btn-primary"
              (click)="currentOffset = 0;devicesList = [];searchDevices()" [disabled]="isDeviceListLoading"><i
                class="fas fa-search fa-sm"></i></button></div>
        </form>
      </div>
      <div class="">
        <ng-container class="" *ngIf="currentPageView === 'list'">
          <div class="" id="table-wrapper">
            <app-common-data-table [tableData]="devicesList" *ngIf="tableConfig"
            [tableConfig]="tableConfig" (btnClickEvent)="onTableFunctionCall($event)"></app-common-data-table>
          </div>
          <span class="pull-right mt-1 mr-1" *ngIf="!insideScrollFunFlag && devicesList.length > 0">
            <a href="javascript:void(0)" class="mr-1" (click)="currentOffset = currentOffset + currentLimit;searchDevices();"
            placement="bottom" tooltip="Load More Records...">Load More...</a>
          </span>
        </ng-container>
        <ng-container *ngIf="currentPageView === 'map'">
          <agm-map #gm [latitude]="centerLatitude" [longitude]="centerLongitude" [styles]="customMapStyle">
            <agm-marker-cluster
            imagePath="./assets/img/m">
          <ng-container  *ngFor="let device of devicesList; let i = index; ">
            <agm-marker *ngIf="device.latitude && device.longitude"
            [latitude]="device.latitude" [longitude]="device.longitude"
            (mouseOver)="onMarkerClick(infowindow, gm)"
            [iconUrl]="device.icon"  >
            <agm-info-window #infowindow >
              <a class="blue-font ml-2" href="javascript:void(0)" (click)="onTableFunctionCall(device)">{{device.display_name ? device.display_name: device.device_id}}</a>
              <!-- <hr>
              <p><b>MTTR:</b> {{device.mttr}}</p>
              <p><b>MTBF:</b> {{device.mtbf}}</p> -->
            </agm-info-window>
            </agm-marker>
          </ng-container>
          </agm-marker-cluster>
          </agm-map>

        </ng-container>
      </div>
  </div>
</div>

<app-add-device *ngIf="isOpenDeviceCreateModal" [deviceDetail]="selectedDeviceForEdit" [gateways]="gateways" (getDeviceEmit)="devicesList = [];searchDevices()"
[componentState]="componentState" [tileData]="tileData" (cancelModal)="onEditDeviceCancelModal()"></app-add-device>
