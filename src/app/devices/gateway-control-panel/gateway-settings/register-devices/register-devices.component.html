
  <i class="fa fa-spinner fa-spin fa-fw fa-2x" *ngIf="isDevicesAPILoading"></i>
  <h6 *ngIf="deviceApps.length === 0 && !isDevicesAPILoading"> No devices available.</h6>
  <accordion [closeOthers]="'true'">
    <accordion-group heading="" [panelClass]="'customClass'" *ngFor="let app of deviceApps">
      <ng-container  accordion-heading>
        <button class="btn" type="button" (click)="selectedDevices = [];isAllDeviceSelected = false;selectedApp = app.app">
            {{app.app_name}}
        </button>
      </ng-container>
      <div class="float-right mt-n2" *ngIf="pageType === 'register-devices'">
      <a
        class="d-none d-sm-inline-block btn btn-sm btn-warning shadow-sm mb-1 mr-2"
        href="javascript:void(0)"
        (click)="registerDevices()"
        ><i class="fa fa- fa-sm text-white-50"></i> Register</a>
        <a
        class="d-none d-sm-inline-block btn btn-sm btn-warning shadow-sm mb-1"
        href="javascript:void(0)"
        (click)="deregisterDevices()"
        ><i class="fa fa- fa-sm text-white-50"></i> Deregister</a>
      </div>
      <div class="float-right mt-n2" *ngIf="pageType === 'telemetry-settings'">
        <a
          class="d-none d-sm-inline-block btn btn-sm btn-warning shadow-sm mb-1 mr-2"
          href="javascript:void(0)"
          (click)="changeTelemetrySetting()"
          ><i class="fa fa- fa-sm text-white-50"></i> Change Settings</a>
        </div>
      <div class="table-responsive">
        <table class="table table-bordered  table-striped text-gray-800" id="dataTable" width="100%" cellspacing="0">
          <thead>
            <tr>
              <th class="text-center"><input type="checkbox" name="visibleall"
                id="visibleall" (change)="onClickOfDeviceAllCheckbox(app.app)" [(ngModel)]="isAllDeviceSelected"
                title="{{isAllDeviceSelected ? 'Deselect All' : 'Select All'}}"/></th>
              <th>Device</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let device of app.devices; let i = index">
              <td  class="text-center">
                <input type="checkbox" name="visible{{i}}"
                    id="visible{{i}}" (change)="onDeviceSelection(device, app.app)"
                    [checked]="checkForDeviceVisibility(device)" />
              </td>
              <td>
                  {{device.display_name}}
              </td>
              <td *ngIf="pageType === 'register-devices'">
                {{device.metadata?.package_app && deviceTwin.twin_properties.reported.registered_devices[device.metadata.package_app] ? (deviceTwin.twin_properties.reported?.registered_devices[device?.metadata?.package_app]?.indexOf(device.device_id) > -1 ? 'Registered' : 'Not Registered') : 'Not Registered'}}
              <td *ngIf="pageType === 'telemetry-settings'">
                <input type="radio" name="visible{{i}}" value="changed"
                    id="visible_1_{{i}}" [(ngModel)]="telemetrySettings[device.device_id]" />
                    <label class="form-label">&nbsp;Ingest Only Changed Properties</label> &nbsp;
                    <input type="radio" name="visible{{i}}" value="all"
                    id="visible_2_{{i}}" [(ngModel)]="telemetrySettings[device.device_id]" />
                    <label class="form-label">&nbsp;Ingest All Properties</label>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </accordion-group>
  </accordion>
  <div class="modal fade" id="confirmMessageModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel2" style="z-index: 1400;">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{headerMessage}}</h5>
          <button type="button" class="close"  aria-label="Close"  (click)="onModalClose()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div>
          <ng-container *ngIf="displyaMsgArr.length > 0">
            <ul>
              <li *ngFor="let msg of displyaMsgArr; let last = last;">
                {{msg.message}}
                <i class="fa fa-check" style="color: green;" *ngIf="!msg.error"></i>
                <i class="fa fa-cancel" style="color: red;" *ngIf="msg.error"></i>
                </li>
            </ul>
          </ng-container>
          <i class="fa fa-spinner fa-spin fa-fw fa-2x" *ngIf="isAPILoading"></i>
          </div>
        </div>
        <div class="modal-footer">

          <button  type="button" class="btn btn-secondary" (click)="onModalClose()">
            Close
          </button>
        </div>
      </div>

    </div>
  </div>
