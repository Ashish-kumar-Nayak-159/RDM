<!-- Page Heading -->
<!-- <div class="d-sm-flex align-items-center justify-content-between mb-4 pt-3">
  <h1 class="h3 mb-0 text-gray-800">Tags</h1>
</div> -->
<div class="topnavbar bg-white py-2" >
  <div class="row">

    <ul class="nav pull-left col-md-6">
      <!-- <li class="nav-item">
        <a class="nav-link" href="javascript:void(0)">
          <i class="fa fa-fw fa-eye"></i>
          <span class="text-secondary">View</span></a>
      </li> -->
      <li class="nav-item">
        <a class="nav-link" href="javascript:void(0)" (click)="updateDeviceTypeTags()" [class.disabled]="isUpdateTagsAPILoading || deviceType.freezed">
          <i class="fa fa-fw fa-save"></i>
          <span class="text-secondary">Save</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="javascript:void(0)" (click)="openModal('confirmMessageModal', 'all', undefined)" [class.disabled]="isUpdateTagsAPILoading || deviceType.freezed">
          <i class="fa fa-fw fa-trash"></i>
          <span class="text-secondary">Delete all</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="javascript:void(0)" (click)="openModal('confirmMessageModal', 'reset', undefined)" [class.disabled]="isUpdateTagsAPILoading || deviceType.freezed">
          <i class="fa fa-fw fa-undo"></i>
          <span class="text-secondary delete-row">Revert Changes</span></a>
      </li>
      <li class="nav-item" *ngIf="isUpdateTagsAPILoading">
        <a class="nav-link" href="javascript:void(0)">
          <i class="fa fa-spinner fa-spin fa-fw fa-2x"></i>
          </a>
        </li>
    </ul>
    <div class="pull-right mt-2"  *ngIf="deviceType.freezed">
      <h6>This model is freezed.</h6>
    </div>
  </div>
    <div class="row">
      <div class="col-lg-12">
        <hr class="solid">
      </div>
    </div>

  </div>

  <div class="con-pad">

  <div class="row mt-1 mx-auto">

    <div class="col-xl-12 col-lg-12">
      <!-- Page Heading -->
      <h1 class="h6 mb-3 text-secondary-400">
        Following tags will be added when asset is instantiated with this model.
        <button type="button" class="btn btn-warning btn-sm mx-2 my-1"  [disabled]="deviceType.freezed"
        title="Add Tag" (click)="addTagObject()" >
          <i class="fa fa-plus fa-sm"></i></button>
      </h1>

      <div class="table-responsive">
        <table class="table table-bordered table-striped" id="dataTable" width="100%" cellspacing="0">
          <thead>
            <tr class="bg-secondary text-white">
              <th>Name</th>
              <th>Key</th>
              <th>Default Value</th>
              <th ></th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="deviceType?.tags?.reserved_tags?.length > 0">
            <tr *ngFor="let tag of deviceType?.tags?.reserved_tags; let i = index;">
              <td >{{tag.name}}</td>
              <td>{{tag.key}}</td>
              <td>{{tag.defaultValue}}</td>
              <td ><a href="javascript:void(0)" class="mx-1" title="Delete" (click)="openModal('confirmMessageModal', 'single', i)"
                [class.disabled]="deviceType.freezed">
                <i class="fa fa-trash fa-sm"></i> </a></td>
            </tr>
          </ng-container>
            <tr *ngIf="tagObj">
              <td><input type="text" min="1" class="form-control form-control-sm mx-2 my-1" id="name" placeholder="Tag Name"
                [(ngModel)]="tagObj.name" name="name"></td>
              <td><input type="text" min="1" class="form-control form-control-sm mx-2 my-1" id="key" placeholder="Tag Key"
                [(ngModel)]="tagObj.key" name="key"></td>
              <td><input type="text" min="1" class="form-control form-control-sm mx-2 my-1" id="defaultValue" placeholder="Default Value"
                [(ngModel)]="tagObj.defaultValue" name="defaultValue"></td>
              <td></td>
            </tr>
            <tr *ngIf="deviceType?.tags?.reserved_tags?.length === 0 && !firstTagAdded">
              <td colspan="4">No Tags added.</td>
            </tr>
            <!-- <tr *ngFor="let tag of reservedTagsBasedOnProtocol">
              <td>{{tag.name}}</td>
              <td>
                <ng-container *ngIf="isReservedTagsEditable">
                  <input type="text" class="form-control form-control-sm bg-light border-0 small"
                  [(ngModel)]="deviceType?.tags[tag.key]" name="{{tag.name}}">
                </ng-container>
                <ng-container *ngIf="!isReservedTagsEditable">
                  {{deviceType?.tags[tag.key]}}
                </ng-container>
              </td>
            </tr> -->
          </tbody>
        </table>
      </div>
    </div>


  </div>
  </div>

  <div class="modal fade" id="confirmMessageModal" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Remove Tags</h5>
          <button type="button" class="close"  aria-label="Close" (click)="closeModal('confirmMessageModal')">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          {{message}}
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" (click)="message.includes('reset') ? resetDeviceTypeTags() : ( deleteTagIndex !== undefined ? removeTag() : deleteAllDeviceTypeTags())">
            Ok</button>
          <button type="button" class="btn btn-secondary" (click)="closeModal('confirmMessageModal')">
            Cancel
          </button>
        </div>
      </div>

    </div>
  </div>
